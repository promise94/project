!function(t){function e(n){if(a[n])return a[n].exports;var o=a[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var a={};return e.m=t,e.c=a,e.p="",e(0)}([function(t,e,a){var n,o;n=[a(1)],!(o=function(t){var e,a=!1,n=!1,o="checkInDay_"+hotelId,s="checkOutDay_"+hotelId,i=function(t){var e=t.split("-"),a=new Date(e[0],parseInt(e[1]-1),e[2]);return a};if("undefined"!=typeof localStorage[o]){var r=i(localStorage[o]),c=new Date;c.setHours(0),c.setMinutes(0),c.setSeconds(0),c.setMilliseconds(0),c.getTime()>r.getTime()&&(localStorage.removeItem(o),localStorage.removeItem(s))}var l=new Vue({el:"#v-app",data:{pageShow:getUrlParams("page")||"intro",hotelInfoShow:!1,hotelInfoData:{},dafaultImg:staticUrl+"src/images/photo-list-default.png",orderNum:0,roomData:{},roomInfo:{},checkInDay:"",checkOutDay:"",nightTotal:"",showMoreBtn:!1,hotelId:hotelId,imgListLength:0,year:(new Date).getFullYear()},methods:{togglePage:function(t){this.pageShow=t;var e="detail?page="+t+"&hotelId="+hotelId;shareTitle="["+comm.hotelName+"]-介绍",descContent="["+comm.hotelName+"]"+this.hotelInfoData.intro,window.history.pushState({},0,e),lineLink=window.location.href,wx.SHARE_ALL(),a=!0},showRoomFull:function(){var t=$("body").scrollTop();console.log(t),$.alert("很抱歉此房间已订满，请选择其它房间"),$(".modal-in").css("marginTop",t)},gotoNav:function(){localStorage.address=this.hotelInfoData.address,localStorage.addressName=this.hotelInfoData.name,location.href="/front/index/navigation?hotelId="+hotelId+"&longitude="+this.hotelInfoData.longitude+"&latitude="+this.hotelInfoData.latitude},goBack:function(){""==document.referrer?location.href="index?hotelId="+hotelId:history.go(-1)},showRoomInfo:function(t,e,a){var n=this;$.ajax({data:{version:version,system:system,lang:lang,APIGEEHEADER2:APIGEEHEADER2,hotelId:hotelId,startDate:n.year+"-"+e,endDate:n.year+"-"+a,roomStyleId:t},url:"/api/Room/getStyleInfo",dataType:"jsonp",type:"get",success:function(t){t.code&&1e3==t.code&&(n.roomInfo=t.content,n.hotelInfoShow=!0,$(".hotelInfo-body")[0].scrollTop=0)},error:function(){console.log("err")}})},GetDateStr:function(t,e){var a=new Date(t);a.setDate(a.getDate()+e);var n=a.getFullYear(),o=a.getMonth()+1,s=a.getDate();return n+"-"+o+"-"+s},getRoomInfo:function(t,e){var a=this;$.ajax({data:{version:version,system:system,lang:lang,APIGEEHEADER2:APIGEEHEADER2,hotelId:hotelId,startDate:t,endDate:e},url:"/api/Room/getStyleList",dataType:"jsonp",type:"get",success:function(t){if(t.code&&1e3==t.code&&null!=t.content){a.roomData=t.content;var e=new Date(t.content.startDate.replace(/-/g,"/")),n=new Date(t.content.endData.replace(/-/g,"/"));a.checkInDay=e.getMonth()+1+"-"+e.getDate(),a.checkOutDay=n.getMonth()+1+"-"+n.getDate(),a.nightTotal=t.content.dayCount}},error:function(){console.log("err")}})}},ready:function(){var e=this;window.addEventListener("popstate",function(t){!/showCalendar/g.test(location.href)&&a&&(console.log("load"),location.reload())}),$(".show-info").on("click",function(){$(".hotel-intro").css({maxHeight:"initial",overflow:"auto"}),$(this).hide()}),validateOnline()&&(securityKey&&$.ajax({data:{version:version,system:system,lang:lang,APIGEEHEADER2:APIGEEHEADER2,hotelId:hotelId,securityKey:securityKey},url:"/api/order/count",dataType:"jsonp",type:"get",success:function(t){t.code&&1e3==t.code&&null!=t.content&&(e.orderNum=t.content.hasOwnProperty("orderTotal")?t.content.orderTotal:0)},error:function(){console.log("err")}}),$.ajax({data:{version:version,system:system,lang:lang,APIGEEHEADER2:APIGEEHEADER2,hotelId:hotelId},url:"/api/Hotel/getInfo",dataType:"jsonp",type:"get",success:function(t){t.code&&1e3==t.code&&null!=t.content&&(e.hotelInfoData=t.content,e.imgListLength=t.content.photoList.length,$(".hotel-phone").removeClass("fn-hide"),"detail"==e.pageShow&&(shareTitle="["+comm.hotelName+"]-介绍",descContent="["+comm.hotelName+"]"+e.hotelInfoData.intro))},error:function(){console.log("err")}}),$.ajax({data:{version:version,system:system,lang:lang,APIGEEHEADER2:APIGEEHEADER2,hotelId:hotelId},url:"/api/Room/getCalendarList",dataType:"jsonp",type:"get",success:function(a){if(a.code&&1e3==a.code&&null!=a.content){var n=function(t){return t<10&&(t="0"+t),Date,t.toString()},i=function(t){var e=t.getFullYear(),a=t.getMonth()+1,o=t.getDate();return e+"-"+n(a)+"-"+n(o)},r=function(){var t=i(h.checkInDay),a=i(h.checkOutDay);e.getRoomInfo(t,a),localStorage[o]=t,localStorage[s]=a},c=e.GetDateStr(a.content.startDate,1);"undefined"==typeof localStorage[o]?(checkIn_Day=new Date(a.content.startDate),checkOut_Day=new Date(c)):(checkIn_Day=new Date(localStorage[o]),checkOut_Day=new Date(localStorage[s]));var l={checkInDay:checkIn_Day,lastDay:new Date(a.content.endDate),checkOutDay:checkOut_Day,maxDay:30,parpendEle:$(".page"),pageSize:2,callback:r},h=new t(l);$(".date-select").on("click",function(t){h.show(),t.preventDefault()}),window.addEventListener("popstate",function(){if(h.isShow)return h.rerurnHide(),!1}),e.getRoomInfo(localStorage[o],localStorage[s])}},error:function(){console.log("err")}}))}});l.$watch("roomInfo",function(){n&&e.destroy(!0),e=new Swiper(".hotelInfo-body .swiper-container",{direction:"horizontal",loop:!0,pagination:"#hotelSwipeNav",paginationType:"fraction",lazyLoading:!0,onInit:function(t){n||(n=!n)}})}),l.$watch("pageShow",function(){var t=5.3*parseInt($("html").css("fontSize")),e=$(".hotel-info").height();e>t&&(this.showMoreBtn=!0,$(".hotel-intro").css({maxHeight:"5.3rem",overflow:"hidden"}))}),l.$watch("hotelInfoData",function(){var t=5.3*parseInt($("html").css("fontSize")),e=$(".hotel-info").height();e>t&&(this.showMoreBtn=!0,$(".hotel-intro").css({maxHeight:"5.3rem",overflow:"hidden"}))}),l.$watch("hotelInfoShow",function(){$(".hotelInfo-body")[0].scrollTop=0})}.apply(e,n))},function(t,e,a){var n,o;n=[a(2),a(3)],o=function(t,e){var a=location.origin+location.pathname+location.search,n=function(t){return this.config=t||!1,!!this.config&&(this.parpendEle=t.parpendEle||$("body"),this.calendarBox=$("<div class='calendarBox'/>"),this.calendarBox_c=$("<div class='calendarBox_c'/>"),this.calendarBox.append(this.header_template).append(this.weekbox_template).append(this.calendarBox_c),this.parpendEle.append(this.calendarBox),this.box_height=this.calendarBox.height(),this.isShow=!1,this.today=new Date,this.checkInDay=t.checkInDay||new Date,this.checkOutDay=t.checkOutDay||null,this.lastDay=t.lastDay||new Date(15552e6+this.checkInDay.getTime()),this.maxDay=t.maxDay||1,this.pageSize=t.pageSize||2,this.fotmatToday=e.formatDay(this.today),this.fotmatLastDay=e.formatDay(this.lastDay),this.callBack=t.callback||!1,this.init(this.config),this.flat=!0,void this.events())};return n.prototype={init:function(t){this.calendarBox.hide(),this.islast_flag=!1,this.canLoad_flag=!0;var a=2;this.today.getMonth()!=this.checkInDay.getMonth()&&(a=2+e.monthDistance(this.today,this.checkInDay)),this.calendarBox_c.html(""),this._year=this.today.getFullYear(),this._month=this.today.getMonth();for(var n=0;n<a;n++)if(this.createCalendar(this._year,this._month),this.increaseMounth(),this.islast_flag){this.calendarBox_c.append('<div class="tips" style="padding-bottom:5px">已加载全部日期</div>');break}this.setCheckInDay(e.formatDay(this.checkInDay)),this.maxDay>1&&(null==this.checkOutDay?$.toast("请选择离店日期"):this.setCheckOutDay(e.formatDay(this.checkOutDay)),this.maxDay>1&&null!=this.checkOutDay&&this.setInnerDay())},header_template:'<header class="bar bar-nav">\t<button class="button button-link button-nav pull-left" >\t    <i class="iconfont icon-login back">&#xe600;</i>\t </button>\t<h1 class="title">选择入住和离店日期</h1></header>',weekbox_template:'<div class="weekBox">\t<span class="weekend">日</span>\t<span class="">一</span>\t<span class="">二</span>\t<span class="">三</span>\t<span class="">四</span>\t<span class="">五</span>\t<span class="weekend">六</span></div>',get_monthBox_template:function(t,a){var n=$("<div class='monthBox' />");n.append('<div class="t">'+t+"-"+e.formatNum(a+1)+"</div>");for(var o=$("<table />"),s=e._getfristDay(t,a),i=e.getWeekCounts(t,a),r=s.getDay(),c=e.getDayCounts(t,a),l=0;l<i;l++){var h=$("<tr />"),d=1;for(d;d<=7;d++){var u=7*l+d-r,f=$("<td />");if(u>=1&&u<=c){var p=e.formatDay(new Date(t,a,u));f.attr({date:p,year:t,month:a,day:u}),e.isToday(t,a,u)?(f.html("今天"),f.addClass("today")):f.html(u),(p<this.fotmatToday||p>this.fotmatLastDay)&&f.addClass("forbit"),this.isWeekend(new Date(t,a,u))&&f.addClass("weekend"),this.islast(p)}h.append(f)}o.append(h)}return n.append(o),n},createCalendar:function(t,e){var a=this.get_monthBox_template(t,e);this.calendarBox_c.append(a),this.getFestival(t,e)},getFestival:function(a,n){var o=parseInt(n)+1;if(o=e.formatNum(o),t.festival&&t.festival[o])for(var s in t.festival[o]){var i=t.festival[o][s];o=e.formatNum(n);var r=a+o+s;$("td[date='"+r+"']").html(i)}if(o=parseInt(n)+1,o=e.formatNum(o),t.lunarFestival&&t.lunarFestival[a]&&t.lunarFestival[a][o])for(var s in t.lunarFestival[a][o]){var i=t.lunarFestival[a][o][s];o=e.formatNum(n);var r=a+o+s;$("td[date='"+r+"']").html(i)}},setSpan:function(t,e){t.find("span").length>0?t.find("span").html(e):t.append("<span>"+e+"<span>")},events:function(){var t=this;this.calendarBox.on("scroll",function(e){var a=t.calendarBox.scrollTop();a+t.box_height-t.calendarBox_c[0].clientHeight>=-0&&!t.islast_flag&&t.canLoad_flag&&(t.canLoad_flag=!1,t.calendarBox_c.append('<div class="tips loading" style="padding-bottom:15px">加载更多日期</div>'),setTimeout(function(){t.loadNewPage(),t.canLoad_flag=!0,t.calendarBox_c.find(".loading").remove()},1e3))}),this.calendarBox_c.on("click",".more",function(){$(this).hide(),t.loadNewPage();var e=$(this);t.calendarBox_c.append(e),t.islast_flag||e.show()}),this.calendarBox_c.on("click","td",function(){if(t.flat&&!$(this).hasClass("forbit")&&0!=$(this).html().length)if(t.maxDay>1)if(null!=t.checkOutDay){t.clearCheckDay();var a=$(this).attr("date");t.setCheckInDay(a),t.flat=!0,setTimeout(function(){null==t.checkOutDay&&$.toast("请选择离店日期")},500)}else{if($(".toast").remove(),$(this).hasClass("select"))return!1;var a=$(this).attr("date"),n=e.formatDay(t.checkInDay);if(a>n)t.flat=!1,t.setCheckOutDay(a);else{t.clearCheckDay();var a=$(this).attr("date");t.setCheckInDay(a)}setTimeout(function(){$(".toast").remove(),t.hide()},500)}else{t.clearCheckDay();var a=$(this).attr("date");t.setCheckInDay(a),setTimeout(function(){t.hide()},500)}}),this.calendarBox.on("click",".pull-left",function(){t.maxDay>1&&null==t.checkOutDay?(t.calendarBox.removeClass("calendarBox_transform_none"),t.parpendEle.removeClass("calendarBox_par"),setTimeout(function(){t.calendarBox.removeClass("calendarBox_show"),setTimeout(function(){t.calendarBox.hide(),t.clearCheckDay(),t.setCheckInDay(e.formatDay(t.bup_checkInDay)),t.setCheckOutDay(e.formatDay(t.bup_checkOutDay)),window.history.go(-1)},300)},100)):t.hide(),t.isShow=!1})},loadNewPage:function(){for(var t=0;t<2;t++)this.islast_flag?this.calendarBox_c.append('<div class="tips" style="padding-bottom:5px">已加载全部日期</div>'):(this.createCalendar(this._year,this._month),this.increaseMounth())},increaseMounth:function(){this._month++,12==this._month&&(this._month=0,this._year++)},islast:function(t){t==this.fotmatLastDay&&(this.islast_flag=!0)},showMoreBtn:function(){return!(this.calendarBox_c.find(".tips").length>0)&&void(!this.islast_flag&&this.box_height>this.calendarBox_c[0].clientHeight&&(this.calendarBox_c.append('<div class="tips more" style="padding-bottom:5px">加载更多</div>'),this.canLoad_flag=!1))},isWeekend:function(t){return 0==t.getDay()||6==t.getDay()},setCheckInDay:function(t){1==this.maxDay?($("td[date='"+t+"']").addClass("select"),this.setSpan($("td[date='"+t+"']"),"选择"),this.checkInDay=e.createDate(t)):($("td[date='"+t+"']").addClass("select"),this.setSpan($("td[date='"+t+"']"),"入住"),this.checkInDay=e.createDate(t))},setCheckOutDay:function(t){var a=e.createDate(t),n=e.dayDistance(a,this.checkInDay);return this.maxDay>1&&n>this.maxDay?($.toast("最多只能预订"+this.maxDay+"天"),this.flat=!0,!1):($("td[date='"+t+"']").addClass("select"),this.setSpan($("td[date='"+t+"']"),"离店"),this.checkOutDay=e.createDate(t),void this.setInnerDay())},setInnerDay:function(){for(var t=e.formatDay(this.checkInDay),a=e.formatDay(this.checkOutDay),n=a-t,o=1;o<n;o++){var s=parseInt(t)+o;$("td[date='"+s+"']").addClass("inner")}},clearCheckDay:function(){this.calendarBox_c.find(".select span").remove(),this.calendarBox_c.find("td").removeClass("select"),this.calendarBox_c.find("td").removeClass("inner"),this.checkInDay=null,this.checkOutDay=null},hide:function(){if(!this.isShow)return!1;var t=this;return this.maxDay>1&&null==this.checkOutDay?($.toast("请选择离店日期"),!1):(this.isShow=!1,t.calendarBox.removeClass("calendarBox_transform_none"),this.parpendEle.removeClass("calendarBox_par"),setTimeout(function(){t.calendarBox.removeClass("calendarBox_show"),setTimeout(function(){t.calendarBox.hide()},300)},100),this.callBack&&setTimeout(function(){t.callBack()},500),void window.history.go(-1))},rerurnHide:function(){var t=this;t.calendarBox.removeClass("calendarBox_transform_none"),t.parpendEle.removeClass("calendarBox_par"),setTimeout(function(){t.calendarBox.removeClass("calendarBox_show"),setTimeout(function(){t.calendarBox.hide(),t.clearCheckDay(),t.setCheckInDay(e.formatDay(t.bup_checkInDay)),t.setCheckOutDay(e.formatDay(t.bup_checkOutDay))},300)},100),this.isShow=!1},show:function(){this.calendarBox.show(),this.showMoreBtn(),this.bup_checkInDay=this.checkInDay,this.bup_checkOutDay=this.checkOutDay,history.pushState(null,"",a+"#showCalendar=1"),this.isShow=!0,this.flat=!0;var t=this;setTimeout(function(){t.parpendEle.addClass("calendarBox_par"),t.calendarBox.addClass("calendarBox_show"),setTimeout(function(){t.calendarBox.addClass("calendarBox_transform_none")},300)},200)}},n}.apply(e,n),!(void 0!==o&&(t.exports=o))},function(t,e,a){var n,o;n=[],o=function(){var t={};return t.festival={"06":{"01":"儿童节"},"07":{"01":"建党节"},"08":{"01":"建军节"},10:{"01":"国庆节"},12:{25:"圣诞节"}},t.lunarFestival={2016:{"09":{15:"中秋节"}}},t}.apply(e,n),!(void 0!==o&&(t.exports=o))},function(t,e,a){var n,o;n=[],o=function(){var t={};return t.formatNum=function(t){return t<10&&(t="0"+t),Date,t.toString()},t.getWeekCounts=function(t,e){var a=new Date(t,e,1).getDay(),n=32-new Date(t,e,32).getDate();return Math.ceil((a+n)/7)},t.getDayCounts=function(t,e){var a=32-new Date(t,e,32).getDate();return a},t._getNextMonth=function(t,e){var a=e+1;return a>=12&&(a=0,t+=1),[t,a]},t._getPreMonth=function(t,e){var a=e-1;return a<0&&(a=11,t-=1),[t,a]},t._getfristDay=function(t,e){var a=new Date;return a.setYear(t),a.setMonth(e),a.setDate(1),a},t.monthDistance=function(e,a){var n=e.getMonth().toString(),o=a.getMonth().toString(),s=e.getFullYear().toString(),i=(a.getFullYear().toString(),s+t.formatNum(n)),r=s+t.formatNum(o),c=Math.abs(i-r);return c},t.dayDistance=function(t,e){var a=t.getTime()-e.getTime();if(0==a)return 0;var n=parseInt(a/864e5);return Math.abs(n)},t.isToday=function(t,e,a){var n=new Date;return a==n.getDate()&&e==n.getMonth()&&t==n.getFullYear()},t.formatDay=function(e){var a=e.getFullYear(),n=e.getMonth(),o=e.getDate();return a+t.formatNum(n)+t.formatNum(o)},t.createDate=function(t){var e=new Date(t.toString().slice(0,4),t.toString().slice(4,6),t.toString().slice(6,8));return e},t.transitionEnd=function(t,e){t.addEventListener("webkitTransitionEnd",e),t.addEventListener("transitionend",e)},t}.apply(e,n),!(void 0!==o&&(t.exports=o))}]);